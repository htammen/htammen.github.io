sap.ui.define(["de/tammenit/ui5/homepage/controller/BaseController","sap/ui/model/json/JSONModel","de/tammenit/ui5/homepage/model/models","sap/m/MessageToast"],function(t,e,n,o){"use strict";return t.extend("de.tammenit.ui5.homepage.controller.Print",{onInit:function(){this.getView().bindElement("/Profiles/0");var t=new e({pdfFull:"./images/pdffull.png",projects:"./images/projects.png"});this.setModel(t,"imgModel")},onAfterRendering:function(){var t=this.getModel("i18n").getProperty("view.profile.print.header");this.setModel(n.createHeaderFragmentController(t),"headerModel")},onPressFullPDF:function(){new Promise(function(t,e){var n=jQuery.sap.getModulePath(this._getComponentName(),"/images/logo_tammenit.png");this.toBase64Url(n,function(e){t(e)})}.bind(this)).then(function(t){o.show("PDF opens in new window / tab");pdfMake.createPdf(this.createPDFDefinition(t)).open()}.bind(this))},onPressAnonymousPDF:function(){o.show("Coming soon")},toBase64Url:function(t,e,n){var o=new Image;o.crossOrigin="Anonymous";o.onload=function(){var t=document.createElement("CANVAS");var o=t.getContext("2d");var r;t.height=this.height;t.width=this.width;o.drawImage(this,0,0);r=t.toDataURL(n);e(r)};o.src=t;if(o.complete||o.complete===undefined){o.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";o.src=t}},createPDFDefinition:function(t){var e=this.getView().getBindingContext();var n=this.getModel("i18n");var o=this.getModel().getProperty(e.getPath());var r=jQuery.extend(true,{},o);r.Projects.splice(5,9);var l=function(){var t=r.Languages.map(function(t){return t.Name});return t.join(", ")};var s=function(){var t={};var e=r.Priorities.map(function(t){var e={text:t.Name+", "};if(t.Rating===1){e.style={bold:true}}else{e.style={color:"#A1A1A1"}}return e});var n=e[e.length-1];n.text=n.text.substring(0,n.text.length-2);return e};var a=function(t){var e={};var n=t.map(function(t){var e={text:t.Name+", "};if(t.Rating>3){e.style={bold:true}}else{e.style={color:"#A1A1A1"}}return e});var o=n[n.length-1];o.text=o.text.substring(0,o.text.length-2);return n};var i=function(){var t=[];if(r.OtherGraduations.length>0){t.push({text:"",style:"columnLeft"});var e=[];r.OtherGraduations.forEach(function(t){e.push({text:t.Text})});t.push(e)}return t};var u=function(t){var e=Date.parse(t);var n=new Date(e);return n};var c=function(){var t=r.Certificates.map(function(t){var e={text:[{text:t.Date+", "},{text:t.Text+", "},{text:t.Rating}]};return e});return t};var d=function(){var t=r.Trainings.map(function(t){var e={text:[{text:t.Date+", "},{text:t.Text+", "},{text:t.Location}]};return e});return t};var m=function(){var t=r.Presentations.map(function(t){var e={text:[{text:this.formatDate(t.Date,"MM / yyyy")+", "},{text:this.getCurrentLangValue(t.Text)+", "},{text:t.Title+", "},{text:t.Location}]};return e}.bind(this));return t};var f=function(){console.log(this);var t=r.Projects.map(function(t){var e=[];e=t.items.map(function(t){var e=[];e.push([{text:this.getCurrentLangValue(t.Start)+" - "+this.getCurrentLangValue(t.End),style:"headerProject"},{text:this.getCurrentLangValue(t.Duration)}]);e.push([{text:this.getCurrentLangValue(t.Branch),style:"headerProject"},{text:this.getCurrentLangValue(t.Header),style:"subHeaderProject"},{text:this.getCurrentLangValue(t.Longtext)},{text:this.getCurrentLangValue(t.Tools),style:"projectTools"}]);return e}.bind(this));return e}.bind(this));var e=[];t.forEach(function(t){e=e.concat(t)});return e};var x=120;var y=15;var h=80;var g=20;var L=60;var p={pageSize:"A4",pageMargins:[y,h,g,L],header:{table:{headerRows:1,widths:[170,"*",170],body:[[{text:[r.Name+"\n",r.Addresses.HomeAddress.Street+" "+r.Addresses.HomeAddress.Housenum+"\n",r.Addresses.HomeAddress.Zipcode+" "+r.Addresses.HomeAddress.City+"\n\n","Email: "+r.Email.Work+"\n","Tel: "+r.Phone.Mobile],style:"headerleft"},{text:n.getProperty("consultant_profile"),style:"headermiddle"},{image:t,width:150,style:"headermiddle"}]]},style:"header"},footer:{},content:[{text:"General Data",style:"header1"},{table:{widths:[x,"*"],body:[[{text:"",style:"columnLeft"},{text:"",style:"columnLeft"}],[{text:"Name: ",style:"columnLeft"},{text:r.Name}],[{text:"Year of birth: ",style:"columnLeft"},{text:r.Birthday}],[{text:"Graduation: ",style:"columnLeft"},{text:r.Graduation}],i(),[{text:"IT Experience: ",style:"columnLeft"},{text:r.ExperienceSince}],[{text:"Nationality: ",style:"columnLeft"},{text:r.Nationality}],[{text:"Languages: ",style:"columnLeft"},{text:l()}],[{text:"",style:"columnLeft"},{text:"",style:"columnLeft"}]]},layout:"noBorders"},{table:{widths:[x,"*"],body:[[{text:"",style:"columnLeft"},{text:"",style:"columnLeft"}],[{text:"Main Focuses: ",style:"columnLeft"},{text:s(r.Priorities)}],[{text:"",style:"columnLeft"},{text:"",style:"columnLeft"}]]},layout:"noBorders"},{table:{widths:[x,"*"],body:[[{text:"",style:"columnLeft"},{text:"",style:"columnLeft"}],[{text:"Branches: ",style:"columnLeft"},{text:a(r.Branches)}],[{text:"",style:"columnLeft"},{text:"",style:"columnLeft"}]]},layout:"noBorders"},{table:{widths:[x,"*"],body:[[{text:"",style:"columnLeft"},{text:"",style:"columnLeft"}],[{text:"Availability: ",style:"columnLeft"},{text:r.Availability}],[{text:"Prefered Regions: ",style:"columnLeft"},{text:r.Regions}],[{text:"",style:"columnLeft"},{text:"",style:"columnLeft"}]]},layout:"noBorders"},{table:{widths:[x,"*"],body:[[{text:"",style:"columnLeft"},{text:"",style:"columnLeft"}],[{text:"Certificates: ",style:"columnLeft"},c()],[{text:"",style:"columnLeft"},{text:"",style:"columnLeft"}]]},layout:"noBorders"},{table:{widths:[x,"*"],body:[[{text:"",style:"columnLeft"},{text:"",style:"columnLeft"}],[{text:"Trainings: ",style:"columnLeft"},d()],[{text:"",style:"columnLeft"},{text:"",style:"columnLeft"}]]},layout:"noBorders"},{table:{widths:[x,"*"],body:[[{text:"",style:"columnLeft"},{text:"",style:"columnLeft"}],[{text:"Presentations: ",style:"columnLeft"},m.bind(this)()],[{text:"",style:"columnLeft"},{text:"",style:"columnLeft"}]]},layout:"noBorders"},{text:"IT Skills",style:"header1",pageBreak:"before"},{table:{pageBreak:"after",widths:[x,"*"],body:[[{text:"",style:"columnLeft"},{text:"",style:"columnLeft"}],[{text:"OS: ",style:"columnLeft"},{text:a(r.ITSkills[0].items)}],[{text:"Programming: ",style:"columnLeft"},{text:a(r.ITSkills[1].items)}],[{text:"Databases: ",style:"columnLeft"},{text:a(r.ITSkills[2].items)}],[{text:"DBAbstraction: ",style:"columnLeft"},{text:a(r.ITSkills[3].items)}],[{text:"SAP: ",style:"columnLeft"},{text:a(r.ITSkills[4].items)}],[{text:"SCM-Tools: ",style:"columnLeft"},{text:a(r.ITSkills[5].items)}],[{text:"Methods: ",style:"columnLeft"},{text:a(r.ITSkills[6].items)}],[{text:"",style:"columnLeft"},{text:"",style:"columnLeft"}]]},layout:"noBorders"},{text:"Projects",style:"header1",pageBreak:"before"},{text:"(only projects of last ~4 years are displayed)",style:["headermiddle","smallFont"]},{table:{pageBreak:"after",widths:[x,"*"],body:f.bind(this)()}}],styles:{header:{margin:5},headermiddle:{alignment:"center"},headerleft:{fontSize:8},columnLeft:{fillColor:"#CDCDCD"},header1:{alignment:"center",fontSize:18,bold:"true"},headerProject:{background:"#CDCDCD",fillColor:"#CDCDCD"},subHeaderProject:{background:"#EBEBEB"},projectTools:{background:"#EBEBEB"},smallFont:{fontSize:8}}};return p}})});