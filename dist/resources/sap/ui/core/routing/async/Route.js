/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/base/Log","sap/base/util/extend","sap/ui/core/Component"],function(t,e,i){"use strict";return{_routeMatched:function(r,a,o){var n=this._oRouter,s,h,g,f,u=null,_=null,l,c,d,p;n._stopWaitingTitleChangedFromChild();n._oMatchedRoute=this;n._bMatchingProcessStarted=true;g=e({},n._oConfig,this._oConfig);h=n.getTargets();var T;if(h){T=h._getTitleTargetName(g.target,g.titleTarget);if(T&&n._oPreviousTitleChangedRoute!==this){n._bFireTitleChanged=true;if(n._oOwner&&n._oOwner._bRoutingPropagateTitle){var C=i.getOwnerComponentFor(n._oOwner);var v=C&&C.getRouter();if(v){v._waitForTitleChangedOn(n)}}}else{n._bFireTitleChanged=false}if(this._oConfig.target){p=h._alignTargetsInfo(this._oConfig.target);p.forEach(function(t){t.propagateTitle=t.hasOwnProperty("propagateTitle")?t.propagateTitle:n._oConfig.propagateTitle;t.routeRelevant=true})}}else{p=this._oConfig.target}if(!a||a===true){l=true;a=Promise.resolve()}if(this._oParent){a=this._oParent._routeMatched(r,a)}else if(this._oNestingParent){this._oNestingParent._routeMatched(r,a,this)}c=Object.assign({},r);c.routeConfig=g;f={name:g.name,arguments:r,config:g};if(o){f.nestedRoute=o}this.fireBeforeMatched(f);n.fireBeforeRouteMatched(f);if(this._oTarget){s=this._oTarget;s._updateOptions(this._convertToTargetOptions(g));a=s._place(a);if(this._oRouter._oTargetHandler&&this._oRouter._oTargetHandler._chainNavigation){d=a;a=this._oRouter._oTargetHandler._chainNavigation(function(){return d})}}else{a=n._oTargets._display(p,c,this._oConfig.titleTarget,a)}return a.then(function(e){n._bMatchingProcessStarted=false;var i,a,o;if(Array.isArray(e)){i=e;e=i[0]}e=e||{};u=e.view;_=e.control;f.view=u;f.targetControl=_;if(i){a=[];o=[];i.forEach(function(t){a.push(t.view);o.push(t.control)});f.views=a;f.targetControls=o}if(g.callback){g.callback(this,r,g,_,u)}this.fireEvent("matched",f);n.fireRouteMatched(f);if(l){t.info("The route named '"+g.name+"' did match with its pattern",this);this.fireEvent("patternMatched",f);n.fireRoutePatternMatched(f)}return e}.bind(this))}}});